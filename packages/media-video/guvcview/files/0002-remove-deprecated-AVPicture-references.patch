From 63db033e3c31139b33f98f859801f4686f45f109 Mon Sep 17 00:00:00 2001
From: Paulo Assis <pj.assis@gmail.com>
Date: Fri, 3 Jun 2016 16:25:30 +0100
Subject: [PATCH 02/19] remove deprecated AVPicture references

---
 gview_v4l2core/jpeg_decoder.c | 3 +--
 gview_v4l2core/uvc_h264.c     | 3 +--
 2 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/gview_v4l2core/jpeg_decoder.c b/gview_v4l2core/jpeg_decoder.c
index f37ce0c..21d2451 100644
--- a/gview_v4l2core/jpeg_decoder.c
+++ b/gview_v4l2core/jpeg_decoder.c
@@ -1538,9 +1538,8 @@ int jpeg_decode(uint8_t *out_buf, uint8_t *in_buf, int size)
 	if(got_picture)
 	{
 #if LIBAVUTIL_VER_AT_LEAST(54,6)
-		const AVPicture *src = (const AVPicture *) codec_data->picture;
 		av_image_copy_to_buffer(jpeg_ctx->tmp_frame, jpeg_ctx->pic_size,
-                             (const uint8_t * const*) src->data, src->linesize,
+                             (const uint8_t * const*) codec_data->picture->data, codec_data->picture->linesize,
                              codec_data->context->pix_fmt, jpeg_ctx->width, jpeg_ctx->height, 1);
 #else
 		avpicture_layout((AVPicture *) codec_data->picture, codec_data->context->pix_fmt, 
diff --git a/gview_v4l2core/uvc_h264.c b/gview_v4l2core/uvc_h264.c
index 7db16b7..828ea89 100644
--- a/gview_v4l2core/uvc_h264.c
+++ b/gview_v4l2core/uvc_h264.c
@@ -1118,9 +1118,8 @@ int h264_decode(uint8_t *out_buf, uint8_t *in_buf, int size)
 	if(got_picture)
 	{
 #if LIBAVUTIL_VER_AT_LEAST(54,6)
-		const AVPicture *src = (const AVPicture *) h264_ctx->picture;
 		av_image_copy_to_buffer(out_buf, h264_ctx->pic_size,
-                             (const uint8_t * const*) src->data, src->linesize,
+                             (const unsigned char * const*) h264_ctx->picture->data, h264_ctx->picture->linesize,
                              h264_ctx->context->pix_fmt, h264_ctx->width, h264_ctx->height, 1);
 #else
 		avpicture_layout((AVPicture *) h264_ctx->picture, h264_ctx->context->pix_fmt, 
-- 
2.10.2

