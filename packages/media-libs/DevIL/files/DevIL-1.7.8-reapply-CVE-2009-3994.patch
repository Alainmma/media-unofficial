Upstream: yes

From 8cf8940410590fe51ab25a07a2f4176f65a25271 Mon Sep 17 00:00:00 2001
From: abma <spring@abma.de>
Date: Sun, 10 Aug 2014 22:59:35 +0200
Subject: [PATCH] reapply CVE-2009-3994

---
 src-IL/src/il_dicom.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src-IL/src/il_dicom.c b/src-IL/src/il_dicom.c
index fbba48c..9fc087d 100644
--- a/src-IL/src/il_dicom.c
+++ b/src-IL/src/il_dicom.c
@@ -427,9 +427,11 @@ ILboolean GetUID(ILubyte *UID)
 		return IL_FALSE;
 
 	ValLen = GetLittleUShort();
+	if (ValLen > 64)
+		return IL_FALSE;
 	if (iread(UID, ValLen, 1) != 1)
 		return IL_FALSE;
-	UID[64] = 0;  // Just to make sure that our string is terminated.
+	UID[ValLen] = 0;  // Just to make sure that our string is terminated.
 
 	return IL_TRUE;
 }
-- 
2.6.0

